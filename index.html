<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mapa de Sucursales</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="anonymous">
  <style>
    html,body{height:100%;margin:0}
    .wrap{display:grid;grid-template-columns:minmax(0,360px) minmax(0,1fr);gap:12px;height:100%;padding:12px;box-sizing:border-box;background:#f2fbf6;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;color:#0a2a1b}
    #panel{border:2px solid rgba(0,170,40,.25);border-radius:16px;background:#fff;display:flex;flex-direction:column;overflow:auto}
    #panel h1{font-size:18px;margin:12px;color:#00A651}
    #list{padding:8px;display:grid;gap:8px;overflow:auto}
    .card{border:1px solid rgba(0,170,40,.25);border-radius:12px;padding:10px}
    .card h3{margin:0 0 4px 0;font-size:14px}
    .card small{color:#2d5a3e}
    #map{width:100%;height:100%;border:2px solid rgba(0,170,40,.25);border-radius:16px;background:#eaf6ee}
    .leaflet-control-zoom{display:none!important}
    @media (max-width:900px){.wrap{grid-template-columns:1fr}#map{height:420px}}
  </style>
</head>
<body>
  <div class="wrap">
    <aside id="panel">
      <h1>Sucursales</h1>
      <div id="list" aria-live="polite"></div>
    </aside>
    <main id="map" aria-label="Mapa"></main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="anonymous"></script>
  <script>
  // ⚠️ Si NO ves nada en GitHub Pages, abre la consola (F12) y mira errores de red.
  // Este archivo es autónomo: no necesita nada más.

  // 1) Datos (muestras + todas las tiendas)
  const STORES = [
    {brand:"El Lagar",name:"Barrio Cuba (100 m sur Liceo del Sur)",city:"San José",url:"https://www.ellagar.com/ECOMMERCE/Locations",lat:9.922967,lng:-84.08824,phone:"+50622179400",hours:"L–V 7:00–17:00; S 7:00–15:00; D 7:30–12:30"},
    {brand:"Ferrevidtek",name:"Filadelfia (75 m N Gasolinera JSM)",city:"Guanacaste",url:"https://www.todosbiz.com/CR/ferrevidtek-8450-2811",lat:10.473,lng:-85.567,phone:"+50684502811",hours:"L–V 8:00–17:30; S 8:30–15:30; D Cerrado"},
    {brand:"JR Vargas e Hijos",name:"Frente al Mercado",city:"Atenas, Alajuela",url:"https://www.facebook.com/FerreteriaJRVargas",lat:9.97874,lng:-84.38159,phone:"+50624468585",hours:"L–V 7:00–17:30; S 7:00–16:30; D Cerrado"},
    {brand:"El Cedral",name:"Santiago de Puriscal (Centro)",city:"Puriscal, San José",url:"https://www.facebook.com/ElCedralCR",lat:9.84748,lng:-84.31361,phone:"+50624166062",hours:"L–V 6:00–18:30; S 6:00–18:00; D Cerrado"},
    {brand:"Ferretería San Luis",name:"Heredia",city:"Heredia",url:"https://www.facebook.com/ferreteriacomercialsanluis",lat:9.9986,lng:-84.1179,phone:"",hours:""},
    {brand:"Ferretería La Solución",name:"Santa Rosa de Sto. Domingo",city:"Heredia",url:"https://sites.google.com/view/ferreterialasolucion",lat:10.004,lng:-84.088,phone:"+50661169176",hours:"24 h"},
    {brand:"Ferretería Palmares",name:"Daniel Flores",city:"Pérez Zeledón",url:"https://www.ferreteriapalmares.com/",lat:9.32099,lng:-83.66666,phone:"+50627718043",hours:"L–V 7:00–18:00; S 7:00–16:00"},
    {brand:"Home Depot",name:"Referencia (CR)",city:"Escazú",url:"https://www.homedepot.com/",lat:9.918,lng:-84.139,phone:"",hours:""},
    {brand:"Grupo Nosara",name:"Materiales Nosara (Centro)",city:"Nosara, Guanacaste",url:"https://gruponosaracr.com/pages/sucursales",lat:9.962866,lng:-85.663816,phone:"+50645001919",hours:"L–S 7:00–17:00"},
    {brand:"Grupo Nosara",name:"Ferretería Nosara (Arenales)",city:"Nosara, Guanacaste",url:"https://gruponosaracr.com/pages/sucursales",lat:9.973337,lng:-85.645617,phone:"+50645001919",hours:"L–S 7:00–17:00"},
    {brand:"Grupo Nosara",name:"Sucursal Nicoya Centro",city:"Nicoya, Guanacaste",url:"https://gruponosaracr.com/pages/sucursales",lat:10.1488,lng:-85.452,phone:"+50645001919",hours:"L–S 7:00–17:00"},
    {brand:"Suministros Venecianos",name:"San José",city:"San José",url:"https://www.veneciacr.com/",lat:9.935,lng:-84.07,phone:"",hours:"L–S 8:00–17:00"},
    {brand:"Ferconce del Sur",name:"Alajuelita / San Francisco",city:"San José",url:"https://ferconce.com/",lat:9.9145,lng:-84.1018,phone:"+50622752121",hours:"L–S 7:00–17:00"},
    {brand:"Preycon CPS",name:"Oficina San Ramón",city:"San Ramón, Alajuela",url:"https://www.bonospreycon.com/",lat:10.087,lng:-84.47,phone:"+50640356922",hours:"L–V 7:00–12:00 y 13:00–16:00"},
    {brand:"Constructora Cover",name:"Oficina Central – Plaza Pococí #9",city:"Guápiles, Limón",url:"https://www.constructoracover.com/",lat:10.2183,lng:-83.7852,phone:"+50621003723",hours:"L–V 8:30–17:00; S 9:00–13:00"},
    {brand:"Ferretería Novoa",name:"San Carlos (Quesada)",city:"Quesada, Alajuela",url:"https://www.facebook.com/ferrnovoa",lat:10.3238,lng:-84.427,phone:"+50624626060",hours:"L–V 7:00–17:00; S 7:00–12:00"},
    {brand:"Constructora Izquierdo",name:"Tamarindo",city:"Guanacaste",url:"https://www.izquierdo.co.cr/",lat:10.299,lng:-85.841,phone:"+50621028844",hours:"L–V 8:00–17:00"},
    {brand:"Tectram",name:"San Ramón",city:"Alajuela",url:"https://www.tectramgroup.com/",lat:10.086,lng:-84.47,phone:"+50640352000",hours:"L–V 8:00–17:00"},
    {brand:"Do It Center",name:"Escazú (referencia)",city:"Escazú",url:"https://grupodoit.com/do-it-center/",lat:9.918,lng:-84.139,phone:"",hours:""}
  ];

  // 2) Mapa simple (OpenStreetMap)
  const map = L.map('map', { zoomControl:false }).setView([9.93,-84.08], 12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution:'&copy; OpenStreetMap', maxZoom:19 }).addTo(map);

  // 3) Render lista + pines
  const list = document.getElementById('list');
  const markers = [];

  function popup(s){
    const g = `https://maps.google.com/?q=${s.lat},${s.lng}`;
    const w = `https://waze.com/ul?ll=${s.lat},${s.lng}&navigate=yes`;
    return `<strong style="color:#00A651">${s.brand}</strong><br>${s.name}<br><small>${s.city||''}</small><br>`+
           `${s.phone?`Tel: <a href="tel:${s.phone}">${s.phone}</a><br>`:''}`+
           `${s.hours?`Horario: ${s.hours}<br>`:''}`+
           `<div style="margin-top:6px"><a href="${s.url}" target="_blank">Sitio</a> · <a href="${g}" target="_blank">Maps</a> · <a href="${w}" target="_blank">Waze</a></div>`;
  }

  function render(items){
    list.innerHTML = '';
    markers.forEach(m => map.removeLayer(m));
    markers.length = 0;

    items.forEach(s => {
      // tarjeta
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `<h3>${s.brand} <small>• ${s.name}</small></h3><small>${s.city||''}</small>`;
      card.addEventListener('click', ()=>{ if (s.lat && s.lng) { map.flyTo([s.lat,s.lng], 16, {duration:0.6}); const mm = markers.find(x=>x.s===s); if (mm) mm.openPopup(); }});
      list.appendChild(card);

      // pin
      if (typeof s.lat==='number' && typeof s.lng==='number'){
        const m = L.marker([s.lat, s.lng]).addTo(map).bindPopup(popup(s));
        m.on('click', ()=> map.flyTo([s.lat,s.lng], 16, {duration:0.5}));
        m.s = s; // referencia
        markers.push(m);
      }
    });

    // encuadre
    const pts = markers.map(m=> m.getLatLng());
    if (pts.length) map.fitBounds(L.latLngBounds(pts).pad(0.2));
  }

  render(STORES);
  </script>
</body>
</html>
